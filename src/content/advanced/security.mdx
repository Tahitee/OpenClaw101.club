# å®‰å…¨åŠ å›º

å®‰å…¨æ˜¯è¿è¡Œ AI ä»£ç†ç³»ç»Ÿæ—¶æœ€ä¸èƒ½å¿½è§†çš„é—®é¢˜ã€‚OpenClaw æä¾›äº†å¤šå±‚å®‰å…¨æœºåˆ¶ï¼Œä» DM è®¿é—®æ§åˆ¶åˆ°å·¥å…·æ²™ç®±ï¼Œå¸®åŠ©ä½ æ„å»ºå®‰å…¨å¯é çš„éƒ¨ç½²ã€‚æœ¬æ–‡å°†ç³»ç»Ÿæ€§åœ°ä»‹ç»å„é¡¹å®‰å…¨åŠŸèƒ½çš„é…ç½®ä¸æœ€ä½³å®è·µã€‚

## openclaw security audit å‘½ä»¤

OpenClaw æä¾›äº†å†…ç½®çš„å®‰å…¨å®¡è®¡å·¥å…·ï¼Œå¸®åŠ©ä½ å‘ç°é…ç½®ä¸­çš„æ½œåœ¨é£é™©ã€‚

### è¿è¡Œå®‰å…¨å®¡è®¡

```bash
# æ‰§è¡Œå®Œæ•´å®‰å…¨å®¡è®¡
openclaw security audit

# è¾“å‡ºç¤ºä¾‹
# ğŸ” OpenClaw Security Audit
# ================================
# [WARN] DM policy is set to "open" - anyone can DM your bot
# [WARN] No tool restrictions configured - all tools are available
# [PASS] API keys are stored in environment variables
# [PASS] Workspace permissions are correctly set
# [WARN] 3 skills have network access without explicit approval
# [FAIL] Sensitive data found in openclaw.yaml (API key hardcoded)
#
# Summary: 1 FAIL, 3 WARN, 2 PASS
```

### å®¡è®¡æ£€æŸ¥é¡¹

å®¡è®¡å‘½ä»¤ä¼šæ£€æŸ¥ä»¥ä¸‹æ–¹é¢ï¼š

- **DM ç­–ç•¥**ï¼šæ˜¯å¦è®¾ç½®äº†è®¿é—®æ§åˆ¶
- **API Key å­˜å‚¨**ï¼šæ˜¯å¦æœ‰ç¡¬ç¼–ç çš„å‡­è¯
- **å·¥å…·æƒé™**ï¼šæ˜¯å¦æœ‰è¿‡äºå®½æ³›çš„å·¥å…·æˆæƒ
- **æŠ€èƒ½å®‰å…¨**ï¼šå·²å®‰è£…æŠ€èƒ½çš„æƒé™éœ€æ±‚
- **æ–‡ä»¶æƒé™**ï¼šé…ç½®æ–‡ä»¶å’Œæ•°æ®ç›®å½•çš„ç³»ç»Ÿæƒé™
- **ç½‘ç»œæš´éœ²**ï¼šGateway æ˜¯å¦æš´éœ²åœ¨å…¬ç½‘

```bash
# åªæ£€æŸ¥ç‰¹å®šç±»åˆ«
openclaw security audit --category credentials
openclaw security audit --category permissions

# è¾“å‡ºä¸º JSON æ ¼å¼ï¼ˆä¾¿äºè‡ªåŠ¨åŒ–ï¼‰
openclaw security audit --format json
```

## DM ç­–ç•¥

DMï¼ˆç§èŠï¼‰ç­–ç•¥æ§åˆ¶ **è°å¯ä»¥ä¸ä½ çš„ AI ç§èŠ**ã€‚è¿™æ˜¯å¤šç”¨æˆ·éƒ¨ç½²ä¸­æœ€é‡è¦çš„å®‰å…¨è®¾ç½®ä¹‹ä¸€ã€‚

### ä¸‰ç§ç­–ç•¥æ¨¡å¼

```yaml
# openclaw.yaml
security:
  dm:
    policy: "pairing"  # pairing | allowlist | open
```

### pairingï¼ˆé…å¯¹æ¨¡å¼ï¼‰â€” æ¨è

ç”¨æˆ·éœ€è¦é€šè¿‡é…å¯¹æµç¨‹æ‰èƒ½ä¸ AI å¯¹è¯ï¼š

```yaml
security:
  dm:
    policy: "pairing"
    pairing:
      # é…å¯¹ç æœ‰æ•ˆæ—¶é—´ï¼ˆç§’ï¼‰
      codeExpiry: 300
      # æ˜¯å¦éœ€è¦ç®¡ç†å‘˜æ‰¹å‡†
      requireApproval: true
```

é…å¯¹æµç¨‹ï¼š
1. ç”¨æˆ·å‘ Bot å‘é€æ¶ˆæ¯
2. Bot å›å¤"è¯·è¾“å…¥é…å¯¹ç "
3. ç®¡ç†å‘˜ç”Ÿæˆé…å¯¹ç å¹¶å‘ç»™ç”¨æˆ·
4. ç”¨æˆ·è¾“å…¥é…å¯¹ç å®Œæˆé…å¯¹
5. åç»­å¯¹è¯æ— éœ€é‡å¤é…å¯¹

```bash
# ç®¡ç†å‘˜ç”Ÿæˆé…å¯¹ç 
openclaw pairing create --user "alice#1234"

# æŸ¥çœ‹å¾…é…å¯¹è¯·æ±‚
openclaw pairing pending

# æ‰¹å‡†/æ‹’ç»é…å¯¹è¯·æ±‚
openclaw pairing approve <request-id>
openclaw pairing reject <request-id>
```

### allowlistï¼ˆç™½åå•æ¨¡å¼ï¼‰

åªå…è®¸åˆ—è¡¨ä¸­çš„ç”¨æˆ·ä¸ AI å¯¹è¯ï¼š

```yaml
security:
  dm:
    policy: "allowlist"
    allowlist:
      # æŒ‰å¹³å°+ç”¨æˆ·IDæŒ‡å®š
      - platform: "discord"
        userId: "123456789"
      - platform: "telegram"
        userId: "987654321"
      # ä¹Ÿæ”¯æŒç”¨æˆ·ååŒ¹é…
      - platform: "discord"
        username: "alice#1234"
```

### openï¼ˆå¼€æ”¾æ¨¡å¼ï¼‰

ä»»ä½•äººéƒ½å¯ä»¥ä¸ AI å¯¹è¯ã€‚**ä»…æ¨èç”¨äºæµ‹è¯•æˆ–ä¸ªäººä½¿ç”¨**ï¼š

```yaml
security:
  dm:
    policy: "open"
    # âš ï¸ è­¦å‘Šï¼šä»»ä½•äººéƒ½å¯ä»¥ä¸ä½ çš„ Bot å¯¹è¯
    # è¿™å¯èƒ½å¯¼è‡´ API è´¹ç”¨å¤±æ§
```

## ç¡¬åŒ–åŸºçº¿é…ç½®ç¤ºä¾‹

ä»¥ä¸‹æ˜¯ä¸€ä¸ªé¢å‘ç”Ÿäº§ç¯å¢ƒçš„å®‰å…¨ç¡¬åŒ–é…ç½®ï¼š

```yaml
# openclaw.yaml â€” å®‰å…¨ç¡¬åŒ–åŸºçº¿é…ç½®

security:
  # DM è®¿é—®æ§åˆ¶
  dm:
    policy: "pairing"
    pairing:
      requireApproval: true
      codeExpiry: 300

  # é€Ÿç‡é™åˆ¶
  rateLimit:
    # æ¯ç”¨æˆ·æ¯åˆ†é’Ÿæœ€å¤§æ¶ˆæ¯æ•°
    messagesPerMinute: 20
    # æ¯ç”¨æˆ·æ¯å¤©æœ€å¤§æ¶ˆæ¯æ•°
    messagesPerDay: 500
    # è¶…é™åçš„è¡Œä¸º
    onExceeded: "reject"  # reject | queue | warn

# å·¥å…·å®‰å…¨
tools:
  profile: "restricted"
  deny:
    - "exec"           # ç¦æ­¢æ‰§è¡Œç³»ç»Ÿå‘½ä»¤
    - "file_delete"    # ç¦æ­¢åˆ é™¤æ–‡ä»¶
    - "network_raw"    # ç¦æ­¢åŸå§‹ç½‘ç»œè®¿é—®

# æ¨¡å‹é™åˆ¶ï¼ˆæ§åˆ¶æˆæœ¬ï¼‰
agents:
  defaults:
    models:
      primary: "anthropic/claude-sonnet-4-20250514"
      denied:
        - "anthropic/claude-opus-4-20250514"
        - "openai/o3"

    # ä¼šè¯å®‰å…¨
    dmScope: "per-peer"
    session:
      idleResetMinutes: 60
      dailyResetHour: 4
```

## å·¥å…·ç­–ç•¥ï¼ˆtools.profile, allow/denyï¼‰

å·¥å…·ç­–ç•¥æ§åˆ¶ AI å¯ä»¥ä½¿ç”¨å“ªäº›å·¥å…·ï¼Œæ˜¯é˜²æ­¢ AI æ‰§è¡Œå±é™©æ“ä½œçš„å…³é”®æœºåˆ¶ã€‚

### tools.profile é¢„è®¾

```yaml
tools:
  # é¢„è®¾å®‰å…¨é…ç½®æ–‡ä»¶
  profile: "default"  # default | restricted | minimal | custom
```

å„é¢„è®¾çš„èƒ½åŠ›èŒƒå›´ï¼š

- **default**ï¼šå…è®¸å¤§éƒ¨åˆ†å·¥å…·ï¼Œç¦æ­¢é«˜å±æ“ä½œï¼ˆå¦‚ç³»ç»Ÿå‘½ä»¤æ‰§è¡Œï¼‰
- **restricted**ï¼šåªå…è®¸è¯»å–ç±»æ“ä½œå’Œå®‰å…¨çš„å†™å…¥æ“ä½œ
- **minimal**ï¼šåªå…è®¸æœ€åŸºæœ¬çš„å¯¹è¯å·¥å…·ï¼Œå‡ ä¹ä¸ä½¿ç”¨å¤–éƒ¨å·¥å…·
- **custom**ï¼šå®Œå…¨è‡ªå®šä¹‰ allow/deny åˆ—è¡¨

### allow/deny åˆ—è¡¨

```yaml
tools:
  profile: "custom"
  
  # å…è®¸ä½¿ç”¨çš„å·¥å…·ï¼ˆç™½åå•ï¼‰
  allow:
    - "read"           # è¯»å–æ–‡ä»¶
    - "web_search"     # æœç´¢ç½‘é¡µ
    - "web_fetch"      # è·å–ç½‘é¡µå†…å®¹
    - "memory_search"  # æœç´¢è®°å¿†
    - "memory_get"     # è·å–è®°å¿†
    - "send_email"     # å‘é€é‚®ä»¶
  
  # æ˜ç¡®ç¦æ­¢çš„å·¥å…·ï¼ˆé»‘åå•ï¼Œä¼˜å…ˆçº§é«˜äº allowï¼‰
  deny:
    - "exec"           # æ‰§è¡Œç³»ç»Ÿå‘½ä»¤
    - "write"          # å†™å…¥æ–‡ä»¶ï¼ˆå¦‚æœä¸éœ€è¦ï¼‰
    - "file_delete"    # åˆ é™¤æ–‡ä»¶
    - "browser"        # æµè§ˆå™¨æ§åˆ¶
```

### ç­–ç•¥ä¼˜å…ˆçº§

```
deny åˆ—è¡¨ > allow åˆ—è¡¨ > profile é¢„è®¾
```

å³ä½¿å·¥å…·åœ¨ `allow` ä¸­å‡ºç°ï¼Œå¦‚æœå®ƒä¹Ÿåœ¨ `deny` ä¸­ï¼Œåˆ™ **å§‹ç»ˆè¢«ç¦æ­¢**ã€‚

### é’ˆå¯¹ä¸åŒåœºæ™¯çš„å·¥å…·ç­–ç•¥

```yaml
# åœºæ™¯ä¸€ï¼šåªè¯»åŠ©æ‰‹ï¼ˆä¿¡æ¯æŸ¥è¯¢ç±»ï¼‰
tools:
  profile: "custom"
  allow:
    - "read"
    - "web_search"
    - "web_fetch"
    - "memory_search"
  deny:
    - "write"
    - "edit"
    - "exec"

# åœºæ™¯äºŒï¼šå¼€å‘åŠ©æ‰‹ï¼ˆéœ€è¦æ–‡ä»¶æ“ä½œï¼‰
tools:
  profile: "default"
  deny:
    - "exec"          # ä»ç„¶ç¦æ­¢ç³»ç»Ÿå‘½ä»¤
    - "browser"       # ä¸éœ€è¦æµè§ˆå™¨

# åœºæ™¯ä¸‰ï¼šå…¨èƒ½åŠ©æ‰‹ï¼ˆä¿¡ä»»ç”¨æˆ·ï¼‰
tools:
  profile: "default"
  # ä¸é¢å¤–é™åˆ¶
```

## æ²™ç®±ç®€ä»‹

OpenClaw æ”¯æŒåœ¨ **æ²™ç®±ç¯å¢ƒ** ä¸­è¿è¡Œå·¥å…·ï¼Œä¸ºå·¥å…·æ‰§è¡Œæä¾›é¢å¤–çš„éš”ç¦»å±‚ã€‚

### æ²™ç®±çš„ä½œç”¨

```
AI è¯·æ±‚æ‰§è¡Œå·¥å…·
    â†“
OpenClaw å·¥å…·è·¯ç”±
    â†“ æ²™ç®±å¯ç”¨
åœ¨éš”ç¦»ç¯å¢ƒä¸­æ‰§è¡Œ
    - ç‹¬ç«‹æ–‡ä»¶ç³»ç»Ÿ
    - ç½‘ç»œè®¿é—®å—é™
    - æ— æ³•è®¿é—®å®¿ä¸»æ•æ„Ÿæ–‡ä»¶
    â†“
è¿”å›ç»“æœç»™ AI
```

### æ²™ç®±é…ç½®

```yaml
# openclaw.yaml
sandbox:
  enabled: true
  # æ²™ç®±ç±»å‹
  type: "container"  # container | nsjail | bubblewrap
  
  # å…è®¸æ²™ç®±è®¿é—®çš„ç›®å½•
  mounts:
    - source: "~/.openclaw/workspace"
      target: "/workspace"
      readOnly: false
    - source: "~/.openclaw/skills"
      target: "/skills"
      readOnly: true
  
  # ç½‘ç»œé™åˆ¶
  network:
    enabled: true
    # å…è®¸çš„å¤–éƒ¨åŸŸå
    allowedDomains:
      - "api.openai.com"
      - "api.anthropic.com"
      - "*.googleapis.com"
  
  # èµ„æºé™åˆ¶
  resources:
    maxMemory: "512m"
    maxCpu: "1.0"
    maxDisk: "1g"
    timeout: 30  # ç§’
```

### ä½•æ—¶ä½¿ç”¨æ²™ç®±

- **è¿è¡Œä¸å¯ä¿¡ä»£ç **ï¼šç”¨æˆ·è¦æ±‚ AI æ‰§è¡Œä»»æ„ä»£ç æ—¶
- **æµ‹è¯•ç¬¬ä¸‰æ–¹æŠ€èƒ½**ï¼šé¦–æ¬¡ä½¿ç”¨æ–°æŠ€èƒ½æ—¶
- **å¤šç§Ÿæˆ·ç¯å¢ƒ**ï¼šå¤šä¸ªç”¨æˆ·å…±äº«åŒä¸€ä¸ª OpenClaw å®ä¾‹æ—¶
- **åˆè§„è¦æ±‚**ï¼šä¼ä¸šç¯å¢ƒä¸­éœ€è¦å·¥å…·æ‰§è¡Œéš”ç¦»

## å‡­è¯å­˜å‚¨ä½ç½®

äº†è§£ OpenClaw åœ¨å“ªé‡Œå­˜å‚¨æ•æ„Ÿä¿¡æ¯ï¼Œæœ‰åŠ©äºä½ æ­£ç¡®ä¿æŠ¤å®ƒä»¬ã€‚

### å‡­è¯å­˜å‚¨è·¯å¾„

```
~/.openclaw/
â”œâ”€â”€ .env                 # ç¯å¢ƒå˜é‡ï¼ˆAPI Keys ç­‰ï¼‰
â”œâ”€â”€ openclaw.yaml        # ä¸»é…ç½®æ–‡ä»¶ï¼ˆä¸åº”åŒ…å«æ˜æ–‡å‡­è¯ï¼‰
â”œâ”€â”€ auth/
â”‚   â”œâ”€â”€ oauth-tokens.json    # OAuth ä»¤ç‰Œ
â”‚   â””â”€â”€ pairing-codes.json   # é…å¯¹ç 
â”œâ”€â”€ sessions/
â”‚   â””â”€â”€ *.json           # ä¼šè¯æ•°æ®ï¼ˆå¯èƒ½åŒ…å«å¯¹è¯å†…å®¹ï¼‰
â””â”€â”€ credentials/
    â””â”€â”€ *.enc            # åŠ å¯†å­˜å‚¨çš„å‡­è¯
```

### ä¿æŠ¤å»ºè®®

```bash
# ç¡®ä¿é…ç½®ç›®å½•æƒé™æ­£ç¡®
chmod 700 ~/.openclaw
chmod 600 ~/.openclaw/.env
chmod 600 ~/.openclaw/auth/*

# æ£€æŸ¥æ˜¯å¦æœ‰æ˜æ–‡å‡­è¯æ³„éœ²
grep -r "sk-" ~/.openclaw/openclaw.yaml
grep -r "password" ~/.openclaw/openclaw.yaml

# ç¡®ä¿ .env ä¸è¢« Git è¿½è¸ª
echo ".env" >> ~/.openclaw/.gitignore
```

### å‡­è¯è½®æ¢

```bash
# å®šæœŸè½®æ¢ API Key
# 1. åœ¨æä¾›å•†æ§åˆ¶å°ç”Ÿæˆæ–° Key
# 2. æ›´æ–° .env æ–‡ä»¶
# 3. é‡å¯ Gateway ä½¿å…¶ç”Ÿæ•ˆ
openclaw gateway restart
```

## å®‰å…¨æ£€æŸ¥æ¸…å•

éƒ¨ç½² OpenClaw åˆ°ç”Ÿäº§ç¯å¢ƒå‰ï¼Œè¯·é€é¡¹æ£€æŸ¥ä»¥ä¸‹æ¸…å•ï¼š

### è®¿é—®æ§åˆ¶

- [ ] DM ç­–ç•¥å·²è®¾ç½®ä¸º `pairing` æˆ– `allowlist`ï¼ˆé `open`ï¼‰
- [ ] é…å¯¹/ç™½åå•å·²æ­£ç¡®é…ç½®
- [ ] é€Ÿç‡é™åˆ¶å·²å¯ç”¨
- [ ] ä¼šè¯éš”ç¦»çº§åˆ« `dmScope` å·²è®¾ç½®ä¸º `per-peer` æˆ–æ›´ç»†

### å·¥å…·ä¸æŠ€èƒ½

- [ ] å·²é…ç½®å·¥å…·ç­–ç•¥ï¼ˆ`tools.profile` æˆ– allow/denyï¼‰
- [ ] å±é™©å·¥å…·å·²è¢«ç¦ç”¨ï¼ˆexec, file_delete ç­‰ï¼‰
- [ ] å·²å®¡æŸ¥æ‰€æœ‰å·²å®‰è£…çš„ç¬¬ä¸‰æ–¹æŠ€èƒ½
- [ ] ä¸éœ€è¦çš„æŠ€èƒ½å·²è¢«ç¦ç”¨

### å‡­è¯ç®¡ç†

- [ ] æ‰€æœ‰ API Key å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡æˆ– `.env` æ–‡ä»¶ä¸­
- [ ] `openclaw.yaml` ä¸­æ²¡æœ‰ç¡¬ç¼–ç å‡­è¯
- [ ] `.env` æ–‡ä»¶æƒé™è®¾ä¸º 600
- [ ] OAuth ä»¤ç‰Œæ–‡ä»¶æƒé™æ­£ç¡®
- [ ] `.env` å·²æ·»åŠ åˆ° `.gitignore`

### ç½‘ç»œå®‰å…¨

- [ ] Gateway ä¸ç›´æ¥æš´éœ²åœ¨å…¬ç½‘ï¼ˆæˆ–æœ‰é˜²ç«å¢™è§„åˆ™ï¼‰
- [ ] å¦‚ä½¿ç”¨æ²™ç®±ï¼Œç½‘ç»œç™½åå•å·²é…ç½®
- [ ] HTTPS/TLS å·²å¯ç”¨ï¼ˆå¦‚æœ Gateway å¯¹å¤–æœåŠ¡ï¼‰

### ç›‘æ§ä¸å®¡è®¡

- [ ] å®šæœŸè¿è¡Œ `openclaw security audit`
- [ ] æ—¥å¿—è®°å½•å·²å¯ç”¨
- [ ] å¼‚å¸¸è¡Œä¸ºå‘Šè­¦å·²é…ç½®
- [ ] å®šæœŸå®¡æŸ¥å¯¹è¯æ—¥å¿—ä¸­çš„å¼‚å¸¸æ¨¡å¼

### æˆæœ¬æ§åˆ¶

- [ ] æ¨¡å‹ç™½åå•å·²é…ç½®ï¼ˆé˜²æ­¢ä½¿ç”¨æ˜‚è´µæ¨¡å‹ï¼‰
- [ ] é€Ÿç‡é™åˆ¶é˜²æ­¢ API è´¹ç”¨çˆ†å‘
- [ ] è®¾ç½®äº†æ¯æ—¥/æ¯æœˆè´¹ç”¨å‘Šè­¦

```bash
# ä¸€é”®æ‰§è¡Œå®‰å…¨å®¡è®¡
openclaw security audit

# æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Š
openclaw security audit --verbose

# ä¿®å¤å·²çŸ¥é—®é¢˜åé‡æ–°å®¡è®¡
openclaw security audit --fix  # è‡ªåŠ¨ä¿®å¤å®‰å…¨é…ç½®
```

å®‰å…¨æ²¡æœ‰ç»ˆç‚¹ï¼Œåªæœ‰æŒç»­æ”¹è¿›ã€‚å»ºè®®æ¯æ¬¡æ›´æ–° OpenClaw æˆ–æ·»åŠ æ–°æŠ€èƒ½åï¼Œéƒ½é‡æ–°è¿è¡Œå®‰å…¨å®¡è®¡ï¼Œç¡®ä¿ä½ çš„éƒ¨ç½²å§‹ç»ˆå¤„äºå®‰å…¨çŠ¶æ€ã€‚

---
> ğŸ’¬ **æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Ÿ** æ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€è®¨è®ºã€‚
