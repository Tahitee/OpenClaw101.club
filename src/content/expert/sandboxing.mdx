---
title: "æ²™ç®±æ¨¡å¼æ·±å…¥ï¼šå®‰å…¨éš”ç¦»æ‰§è¡ŒçŽ¯å¢ƒ"
description: "æ·±å…¥ç†è§£ OpenClaw çš„æ²™ç®±æœºåˆ¶ï¼ŒåŒ…æ‹¬æ¨¡å¼ã€ä½œç”¨åŸŸã€Docker é•œåƒé…ç½®å’Œå®‰å…¨å®žè·µ"
---

# æ²™ç®±æ¨¡å¼æ·±å…¥ï¼šå®‰å…¨éš”ç¦»æ‰§è¡ŒçŽ¯å¢ƒ

OpenClaw çš„ Agent æ‹¥æœ‰æ‰§è¡Œä»£ç ã€æ“ä½œæ–‡ä»¶ç³»ç»Ÿã€è¿è¡Œæµè§ˆå™¨ç­‰å¼ºå¤§èƒ½åŠ›ã€‚ä½†èƒ½åŠ›è¶Šå¤§ï¼Œé£Žé™©è¶Šå¤§ â€”â€” ä¸€ä¸ªä¸å°å¿ƒçš„ `rm -rf /` å°±å¯èƒ½é…¿æˆå¤§ç¥¸ã€‚æ²™ç®±ï¼ˆSandboxï¼‰æœºåˆ¶ä¸º Agent çš„æ‰§è¡ŒçŽ¯å¢ƒæä¾›éš”ç¦»ä¿æŠ¤ï¼Œè®©ä½ æ—¢èƒ½äº«å— AI è‡ªåŠ¨åŒ–çš„ä¾¿åˆ©ï¼Œåˆèƒ½å®ˆä½å®‰å…¨åº•çº¿ã€‚

## ä¸ºä»€ä¹ˆéœ€è¦æ²™ç®±ï¼Ÿ

### é£Žé™©åœºæ™¯

è€ƒè™‘ä»¥ä¸‹çœŸå®žåœºæ™¯ï¼š

- **è¯¯æ“ä½œ**ï¼šAgent æ‰§è¡Œæ¸…ç†è„šæœ¬æ—¶è¯¯åˆ äº†é‡è¦æ–‡ä»¶
- **æ¶æ„æ³¨å…¥**ï¼šç”¨æˆ·é€šè¿‡å¯¹è¯è¯±å¯¼ Agent æ‰§è¡Œå±é™©å‘½ä»¤ï¼ˆprompt injectionï¼‰
- **è„šæœ¬æ¼æ´ž**ï¼šAgent å®‰è£…çš„ç¬¬ä¸‰æ–¹ Skill åŒ…å«æ¶æ„ä»£ç 
- **èµ„æºè€—å°½**ï¼šAgent è¿è¡Œçš„ç¨‹åºå ç”¨è¿‡å¤š CPU/å†…å­˜ï¼Œå½±å“å®¿ä¸»æœº
- **æ•°æ®æ³„éœ²**ï¼šAgent æ„å¤–è¯»å–äº†ä¸è¯¥çœ‹çš„ç³»ç»Ÿæ–‡ä»¶

### æ²™ç®±çš„ä½œç”¨

æ²™ç®±é€šè¿‡ Docker å®¹å™¨å°† Agent çš„æ‰§è¡ŒçŽ¯å¢ƒä¸Žå®¿ä¸»æœºéš”ç¦»ï¼š

- âœ… Agent æ‰§è¡Œçš„å‘½ä»¤åœ¨å®¹å™¨å†…è¿è¡Œï¼Œæ— æ³•å½±å“å®¿ä¸»æœº
- âœ… æ–‡ä»¶ç³»ç»Ÿéš”ç¦»ï¼Œåªèƒ½è®¿é—®æŽˆæƒçš„ç›®å½•
- âœ… ç½‘ç»œå¯ä»¥é™åˆ¶
- âœ… èµ„æºä½¿ç”¨å¯æŽ§ï¼ˆCPUã€å†…å­˜é™åˆ¶ï¼‰
- âœ… å®¹å™¨é”€æ¯åŽï¼Œä¸´æ—¶æ–‡ä»¶è‡ªåŠ¨æ¸…ç†

## sandbox.mode â€”â€” æ²™ç®±æ¨¡å¼

OpenClaw æä¾›ä¸‰ç§æ²™ç®±æ¨¡å¼ï¼š

```yaml
# config.yaml
sandbox:
  mode: "non-main"    # off | non-main | all
```

### `off` â€”â€” å…³é—­æ²™ç®±

```yaml
sandbox:
  mode: "off"
```

æ‰€æœ‰å‘½ä»¤ç›´æŽ¥åœ¨å®¿ä¸»æœºä¸Šæ‰§è¡Œã€‚é€‚åˆï¼š

- å¼€å‘è°ƒè¯•é˜¶æ®µ
- å®Œå…¨ä¿¡ä»»çš„å•ç”¨æˆ·çŽ¯å¢ƒ
- éœ€è¦è®¿é—®å®¿ä¸»æœºç‰¹å®šç¡¬ä»¶æˆ–æœåŠ¡

> âš ï¸ **é£Žé™©æžé«˜**ï¼šAgent æ‹¥æœ‰ä¸Žè¿è¡Œç”¨æˆ·ç›¸åŒçš„ç³»ç»Ÿæƒé™ã€‚ä¸å»ºè®®åœ¨ç”Ÿäº§çŽ¯å¢ƒä½¿ç”¨ã€‚

### `non-main` â€”â€” éžä¸»ä¼šè¯æ²™ç®±åŒ–ï¼ˆæŽ¨èï¼‰

```yaml
sandbox:
  mode: "non-main"
```

- **ä¸»ä¼šè¯**ï¼ˆç›´æŽ¥ä¸Ž Agent å¯¹è¯ï¼‰ï¼šä¸ä½¿ç”¨æ²™ç®±ï¼Œå‘½ä»¤ç›´æŽ¥æ‰§è¡Œ
- **éžä¸»ä¼šè¯**ï¼ˆå­ Agentã€Cron ä»»åŠ¡ã€Heartbeat ç­‰ï¼‰ï¼šåœ¨æ²™ç®±ä¸­æ‰§è¡Œ

é€‚åˆï¼š

- æ—¥å¸¸ä½¿ç”¨çš„å¹³è¡¡æ–¹æ¡ˆ
- ä¸»äººç›´æŽ¥å¯¹è¯æ—¶éœ€è¦å®Œæ•´æƒé™ï¼Œè‡ªåŠ¨ä»»åŠ¡éœ€è¦éš”ç¦»

### `all` â€”â€” å…¨éƒ¨æ²™ç®±åŒ–

```yaml
sandbox:
  mode: "all"
```

æ‰€æœ‰å‘½ä»¤éƒ½åœ¨æ²™ç®±å®¹å™¨ä¸­æ‰§è¡Œï¼ŒåŒ…æ‹¬ä¸»ä¼šè¯ã€‚æœ€å®‰å…¨ä½†ä¹Ÿæœ€å—é™ã€‚

é€‚åˆï¼š

- å¤šç”¨æˆ·å…±äº«çŽ¯å¢ƒ
- é«˜å®‰å…¨è¦æ±‚åœºæ™¯
- ä¸éœ€è¦ Agent æ“ä½œå®¿ä¸»æœº

## sandbox.scope â€”â€” æ²™ç®±ä½œç”¨åŸŸ

ä½œç”¨åŸŸå†³å®šæ²™ç®±å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸå’Œå…±äº«æ–¹å¼ï¼š

```yaml
sandbox:
  scope: "session"    # session | agent | shared
```

### `session` â€”â€” ä¼šè¯çº§éš”ç¦»

```yaml
sandbox:
  scope: "session"
```

æ¯ä¸ªä¼šè¯åˆ›å»ºç‹¬ç«‹çš„æ²™ç®±å®¹å™¨ï¼Œä¼šè¯ç»“æŸåŽå®¹å™¨é”€æ¯ã€‚

- âœ… æœ€é«˜éš”ç¦»çº§åˆ«ï¼Œä¼šè¯ä¹‹é—´å®Œå…¨ç‹¬ç«‹
- âœ… ä¸´æ—¶æ–‡ä»¶è‡ªåŠ¨æ¸…ç†
- âŒ æ¯æ¬¡ä¼šè¯éƒ½è¦é‡æ–°åˆå§‹åŒ–çŽ¯å¢ƒ
- âŒ è·¨ä¼šè¯æ— æ³•å…±äº«çŠ¶æ€

### `agent` â€”â€” Agent çº§å…±äº«

```yaml
sandbox:
  scope: "agent"
```

åŒä¸€ä¸ª Agent çš„æ‰€æœ‰ä¼šè¯å…±äº«åŒä¸€ä¸ªæ²™ç®±å®¹å™¨ã€‚

- âœ… ä¼šè¯ä¹‹é—´å¯ä»¥å…±äº«æ–‡ä»¶å’ŒçŠ¶æ€
- âœ… ä¸åŒ Agent ä¹‹é—´ä»ç„¶éš”ç¦»
- âœ… çŽ¯å¢ƒåªåˆå§‹åŒ–ä¸€æ¬¡
- âŒ ä¸€ä¸ªä¼šè¯çš„æ“ä½œå¯èƒ½å½±å“å¦ä¸€ä¸ªä¼šè¯

### `shared` â€”â€” å…¨å±€å…±äº«

```yaml
sandbox:
  scope: "shared"
```

æ‰€æœ‰ Agent å…±äº«åŒä¸€ä¸ªæ²™ç®±å®¹å™¨ã€‚

- âœ… èµ„æºåˆ©ç”¨æœ€é«˜æ•ˆ
- âœ… Agent ä¹‹é—´å¯ä»¥å…±äº«æ•°æ®
- âŒ éš”ç¦»æ€§æœ€ä½Ž

## workspaceAccess â€”â€” å·¥ä½œç©ºé—´è®¿é—®æƒé™

æŽ§åˆ¶æ²™ç®±å†…å¯¹ Agent å·¥ä½œç©ºé—´çš„è®¿é—®çº§åˆ«ï¼š

```yaml
sandbox:
  workspaceAccess: "rw"    # none | ro | rw
```

| å€¼ | è¯´æ˜Ž | é€‚ç”¨åœºæ™¯ |
|------|------|---------|
| `none` | æ— æ³•è®¿é—®å·¥ä½œç©ºé—´ | çº¯è®¡ç®—ä»»åŠ¡ï¼Œä¸éœ€è¦æ–‡ä»¶ |
| `ro` | åªè¯»è®¿é—® | æ•°æ®åˆ†æžã€æŠ¥å‘Šç”Ÿæˆ |
| `rw` | è¯»å†™è®¿é—® | æ­£å¸¸å·¥ä½œæ¨¡å¼ï¼Œå¯åˆ›å»º/ä¿®æ”¹æ–‡ä»¶ |

```yaml
# å…¸åž‹é…ç½®ï¼šå…è®¸è¯»å†™å·¥ä½œç©ºé—´
sandbox:
  mode: "non-main"
  scope: "agent"
  workspaceAccess: "rw"
```

## Docker é•œåƒé…ç½®

æ²™ç®±è¿è¡Œåœ¨ Docker å®¹å™¨ä¸­ï¼Œä½ å¯ä»¥è‡ªå®šä¹‰ä½¿ç”¨çš„åŸºç¡€é•œåƒã€‚

### ä½¿ç”¨é»˜è®¤é•œåƒ

OpenClaw æä¾›é¢„æž„å»ºçš„æ²™ç®±é•œåƒï¼ŒåŒ…å«å¸¸ç”¨å·¥å…·ï¼š

```yaml
sandbox:
  image: "ghcr.io/anthropics/openclaw-sandbox:latest"
```

é»˜è®¤é•œåƒåŒ…å«ï¼š

- Python 3.11 + pip
- Node.js 22 + npm
- Git, curl, wget
- å¸¸ç”¨ç¼–è¯‘å·¥å…·ï¼ˆgcc, makeï¼‰
- Chromiumï¼ˆç”¨äºŽæ²™ç®±æµè§ˆå™¨ï¼‰

### è‡ªå®šä¹‰é•œåƒ

å¦‚æžœé»˜è®¤é•œåƒä¸æ»¡è¶³éœ€æ±‚ï¼Œå¯ä»¥æž„å»ºè‡ªå®šä¹‰é•œåƒï¼š

```dockerfile
# Dockerfile.sandbox
FROM ghcr.io/anthropics/openclaw-sandbox:latest

# å®‰è£…é¢å¤–å·¥å…·
RUN apt-get update && apt-get install -y \
    ffmpeg \
    imagemagick \
    postgresql-client \
    && rm -rf /var/lib/apt/lists/*

# å®‰è£… Python åŒ…
RUN pip3 install \
    pandas \
    numpy \
    matplotlib \
    requests \
    beautifulsoup4

# å®‰è£… Node.js åŒ…
RUN npm install -g \
    typescript \
    tsx

# è‡ªå®šä¹‰é…ç½®
COPY custom-config /etc/custom-config
```

æž„å»ºå¹¶ä½¿ç”¨ï¼š

```bash
# æž„å»ºé•œåƒ
docker build -f Dockerfile.sandbox -t my-openclaw-sandbox:latest .

# åœ¨é…ç½®ä¸­å¼•ç”¨
```

```yaml
sandbox:
  image: "my-openclaw-sandbox:latest"
```

### å¤šé•œåƒé…ç½®

ä¸åŒ Agent å¯ä»¥ä½¿ç”¨ä¸åŒçš„æ²™ç®±é•œåƒï¼š

```yaml
agents:
  list:
    coder:
      sandbox:
        image: "my-sandbox-dev:latest"     # å¼€å‘å·¥å…·é½å…¨
    analyst:
      sandbox:
        image: "my-sandbox-data:latest"    # æ•°æ®åˆ†æžå·¥å…·
```

## è‡ªå®šä¹‰ Bind Mounts

é™¤äº†å·¥ä½œç©ºé—´ï¼Œä½ å¯èƒ½éœ€è¦å°†å®¿ä¸»æœºçš„å…¶ä»–ç›®å½•æŒ‚è½½åˆ°æ²™ç®±ä¸­ï¼š

```yaml
sandbox:
  mounts:
    # åªè¯»æŒ‚è½½æ•°æ®é›†ç›®å½•
    - source: /data/datasets
      target: /datasets
      readonly: true

    # è¯»å†™æŒ‚è½½è¾“å‡ºç›®å½•
    - source: /data/output
      target: /output
      readonly: false

    # æŒ‚è½½ SSH å¯†é’¥ï¼ˆåªè¯»ï¼‰
    - source: ~/.ssh
      target: /root/.ssh
      readonly: true

    # æŒ‚è½½ Docker socketï¼ˆå…è®¸æ²™ç®±å†…æ“ä½œ Dockerï¼‰
    - source: /var/run/docker.sock
      target: /var/run/docker.sock
      readonly: false
```

> âš ï¸ **å®‰å…¨è­¦å‘Š**ï¼šæŒ‚è½½ Docker socket æ„å‘³ç€æ²™ç®±å†…å¯ä»¥æŽ§åˆ¶å®¿ä¸»æœºçš„ Dockerï¼Œç­‰åŒäºŽ root æƒé™ã€‚ä»…åœ¨ä¿¡ä»»çš„çŽ¯å¢ƒä¸­ä½¿ç”¨ã€‚

### æŒ‚è½½æœ€ä½³å®žè·µ

1. **æœ€å°åŒ–æŒ‚è½½**ï¼šåªæŒ‚è½½å¿…éœ€çš„ç›®å½•
2. **ä¼˜å…ˆåªè¯»**ï¼šé™¤éžéœ€è¦å†™å…¥ï¼Œå¦åˆ™ä½¿ç”¨ `readonly: true`
3. **é¿å…æ•æ„Ÿç›®å½•**ï¼šä¸è¦æŒ‚è½½ `/etc`, `/root` ç­‰æ•æ„Ÿç³»ç»Ÿç›®å½•
4. **ä½¿ç”¨ä¸“ç”¨ç›®å½•**ï¼šåˆ›å»ºä¸“é—¨çš„å…±äº«ç›®å½•ï¼Œè€Œä¸æ˜¯æŒ‚è½½æ•´ä¸ª home

## æ²™ç®±æµè§ˆå™¨

å½“æ²™ç®±æ¨¡å¼å¯ç”¨æ—¶ï¼Œæµè§ˆå™¨ä¹Ÿè¿è¡Œåœ¨æ²™ç®±å®¹å™¨å†…ï¼š

```yaml
sandbox:
  mode: "all"
  browser:
    enabled: true
    # æ²™ç®±æµè§ˆå™¨ä½¿ç”¨ Chromium
    # ä»¥æ— å¤´æ¨¡å¼è¿è¡Œï¼Œé€šè¿‡ CDP åè®®æŽ§åˆ¶
```

æ²™ç®±æµè§ˆå™¨ä¸Ž `openclaw` profile çš„æµè§ˆå™¨è¡Œä¸ºä¸€è‡´ï¼Œä½†è¿è¡Œåœ¨éš”ç¦»çŽ¯å¢ƒä¸­ï¼š

- âœ… æµè§ˆå™¨è¿›ç¨‹æ— æ³•è®¿é—®å®¿ä¸»æœºæ–‡ä»¶ç³»ç»Ÿ
- âœ… æµè§ˆå™¨çš„ç½‘ç»œå¯ä»¥å—é™
- âœ… æµè§ˆå™¨å´©æºƒä¸å½±å“å®¿ä¸»æœº
- âŒ æ— æ³•ä½¿ç”¨ Chrome Extension Relayï¼ˆéœ€è¦ä½¿ç”¨ `chrome` profileï¼‰

## å®Œæ•´é…ç½®ç¤ºä¾‹

### ä¸ªäººä½¿ç”¨ï¼ˆå¹³è¡¡å®‰å…¨ä¸Žä¾¿åˆ©ï¼‰

```yaml
sandbox:
  mode: "non-main"
  scope: "agent"
  workspaceAccess: "rw"
  image: "ghcr.io/anthropics/openclaw-sandbox:latest"
  resources:
    memory: "2g"
    cpus: "2.0"
```

### å¤šç”¨æˆ·å…±äº«ï¼ˆé«˜å®‰å…¨ï¼‰

```yaml
sandbox:
  mode: "all"
  scope: "session"
  workspaceAccess: "rw"
  image: "my-locked-sandbox:latest"
  resources:
    memory: "1g"
    cpus: "1.0"
  network: "none"          # ç¦ç”¨ç½‘ç»œ
  mounts: []               # ä¸æŒ‚è½½é¢å¤–ç›®å½•
```

### å¼€å‘çŽ¯å¢ƒï¼ˆåŠŸèƒ½ä¼˜å…ˆï¼‰

```yaml
sandbox:
  mode: "off"
  # å¼€å‘é˜¶æ®µå…³é—­æ²™ç®±ï¼Œå……åˆ†åˆ©ç”¨ç³»ç»Ÿå·¥å…·
  # âš ï¸ ä¸Šçº¿å‰åŠ¡å¿…åˆ‡æ¢åˆ° non-main æˆ– all
```

## å®‰å…¨æ³¨æ„äº‹é¡¹

### 1. å®šæœŸæ›´æ–°é•œåƒ

```bash
# æ‹‰å–æœ€æ–°æ²™ç®±é•œåƒ
docker pull ghcr.io/anthropics/openclaw-sandbox:latest

# æ¸…ç†æ—§é•œåƒ
docker image prune -f
```

### 2. èµ„æºé™åˆ¶

é˜²æ­¢æ²™ç®±å†…ç¨‹åºè€—å°½å®¿ä¸»æœºèµ„æºï¼š

```yaml
sandbox:
  resources:
    memory: "2g"           # æœ€å¤§å†…å­˜
    cpus: "2.0"            # æœ€å¤§ CPU æ ¸æ•°
    pids: 256              # æœ€å¤§è¿›ç¨‹æ•°
    storage: "10g"         # æœ€å¤§å­˜å‚¨ç©ºé—´
```

### 3. ç½‘ç»œæŽ§åˆ¶

```yaml
sandbox:
  network: "bridge"        # bridgeï¼ˆé»˜è®¤ï¼‰| host | none
  # none: å®Œå…¨ç¦æ­¢ç½‘ç»œè®¿é—®
  # bridge: é€šè¿‡ Docker ç½‘æ¡¥è®¿é—®ï¼ˆå¯é…ç½®é˜²ç«å¢™è§„åˆ™ï¼‰
  # host: ä½¿ç”¨å®¿ä¸»æœºç½‘ç»œï¼ˆä¸æŽ¨èï¼‰
```

### 4. ç›‘æŽ§å’Œå®¡è®¡

```bash
# æŸ¥çœ‹æ²™ç®±å®¹å™¨çŠ¶æ€
docker ps --filter "label=openclaw.sandbox=true"

# æŸ¥çœ‹èµ„æºä½¿ç”¨
docker stats --filter "label=openclaw.sandbox=true"

# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs openclaw-sandbox-main
```

### 5. å®‰å…¨æ£€æŸ¥æ¸…å•

- âœ… ç”Ÿäº§çŽ¯å¢ƒä¸ä½¿ç”¨ `mode: "off"`
- âœ… è®¾ç½®å†…å­˜å’Œ CPU é™åˆ¶
- âœ… ä¸æŒ‚è½½ Docker socketï¼ˆé™¤éžå¿…è¦ï¼‰
- âœ… å®šæœŸæ›´æ–°æ²™ç®±é•œåƒ
- âœ… æ•æ„Ÿç›®å½•ä½¿ç”¨åªè¯»æŒ‚è½½
- âœ… å¤šç”¨æˆ·åœºæ™¯ä½¿ç”¨ `scope: "session"`
- âœ… å®¡è®¡æ²™ç®±å†…çš„å‘½ä»¤æ‰§è¡Œè®°å½•

---

> ðŸ’¬ **æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Ÿ** æ¬¢è¿Žåœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€è®¨è®ºã€‚
